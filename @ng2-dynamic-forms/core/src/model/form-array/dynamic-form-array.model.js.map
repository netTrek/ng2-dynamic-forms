{"version":3,"sources":["core/src/model/form-array/dynamic-form-array.model.ts"],"names":[],"mappings":"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","file":"dynamic-form-array.model.js","sourcesContent":["import {ValidatorFn, AsyncValidatorFn} from \"@angular/forms\";\nimport {DynamicFormControlModel, DynamicFormControlModelConfig, ClsConfig} from \"../dynamic-form-control.model\";\nimport {DynamicFormValueControlModel} from \"../dynamic-form-value-control.model\";\nimport {serializable} from \"../../decorator/serializable.decorator\";\nimport {getValue, isFunction, serialize} from \"../../utils\";\n\nexport class DynamicFormArrayGroupModel {\n\n    context: DynamicFormArrayModel;\n    @serializable() group: Array<DynamicFormValueControlModel<any>>;\n    @serializable() index: number | null;\n\n    constructor(context: DynamicFormArrayModel, group: Array<DynamicFormValueControlModel<any>> = [], index: number | null = null) {\n\n        this.context = context;\n        this.group = group;\n        this.index = index;\n    }\n\n    toJSON() {\n        return serialize(this);\n    }\n}\n\nexport const DYNAMIC_FORM_CONTROL_TYPE_ARRAY = \"ARRAY\";\n\nexport interface DynamicFormArrayModelConfig extends DynamicFormControlModelConfig {\n\n    asyncValidator?: AsyncValidatorFn;\n    createGroup?: () => Array<DynamicFormValueControlModel<any>>;\n    groups?: Array<DynamicFormArrayGroupModel>;\n    initialCount?: number;\n    validator?: ValidatorFn;\n}\n\nexport class DynamicFormArrayModel extends DynamicFormControlModel {\n\n    @serializable() asyncValidator: AsyncValidatorFn | null;\n    createGroup: () => Array<DynamicFormValueControlModel<any>>;\n    @serializable() groups: Array<DynamicFormArrayGroupModel> = [];\n    @serializable() initialCount: number;\n    @serializable() validator: ValidatorFn | null;\n\n    @serializable() readonly type: string = DYNAMIC_FORM_CONTROL_TYPE_ARRAY;\n\n    @serializable() private originGroup: Array<DynamicFormValueControlModel<any>>; // only to reinstantiate from JSON\n\n    constructor(config: DynamicFormArrayModelConfig, cls?: ClsConfig) {\n\n        super(config, cls);\n\n        if (!isFunction(config[\"createGroup\"])) {\n            throw new Error(\"createGroup function must be specified for DynamicFormArrayModel\");\n        }\n\n        this.asyncValidator = getValue(config, \"asyncValidator\", null);\n        this.createGroup = config[\"createGroup\"];\n        this.initialCount = getValue(config, \"initialCount\", 1);\n        this.originGroup = this.createGroup();\n        this.validator = getValue(config, \"validator\", null);\n\n        if (Array.isArray(config.groups)) {\n\n            config.groups.forEach((arrayGroup, index) => {\n                this.groups.push(new DynamicFormArrayGroupModel(this, arrayGroup.group, arrayGroup.index || index));\n            });\n\n        } else {\n\n            for (let i = 0; i < this.initialCount; i += 1) {\n                this.addGroup();\n            }\n        }\n    }\n\n    updateGroupIndex(): void {\n        this.groups.forEach((group, index) => group.index = index);\n    }\n\n    addGroup(): DynamicFormArrayGroupModel {\n\n        let group = new DynamicFormArrayGroupModel(this, this.createGroup());\n\n        this.groups.push(group);\n        this.updateGroupIndex();\n\n        return group;\n    }\n\n    insertGroup(index: number): DynamicFormArrayGroupModel {\n\n        let group = new DynamicFormArrayGroupModel(this, this.createGroup());\n\n        this.groups.splice(index, 0, group);\n        this.updateGroupIndex();\n\n        return group;\n    }\n\n    removeGroup(index: number): void {\n\n        this.groups.splice(index, 1);\n        this.updateGroupIndex();\n    }\n}"]}